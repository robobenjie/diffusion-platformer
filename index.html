<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dimension Hopper</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        canvas {
            display: block;
            margin: auto;
            background-color: rgb(31, 46, 52);
        }
    </style>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="/images/favicon_io/site.webmanifest">
    <meta property="og:image" content="https://dimensionhopper.com/logo_maps/171fbeb54115bb935774fcad53b172e871d33991d90f0574aa20d99d344d0167/background_image_834413b8-0072-11ee-b996-00155d01dc50.png">
    <meta property="og:image:width" content="800">
    <meta property="og:image:height" content="544">
    <style>
        .hideable {
            display: none;
        }
        /* Make a button huge by increasing its font size and padding */
        .button.is-huge {
            font-size: 2em;
            padding: 20px 30px;
        }
        
        /* Center a block element */
        .is-center {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 10vh; /* This is to center vertically, you can adjust it as per your need */
        }
    </style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WCWTYCDSDV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WCWTYCDSDV');
</script>
<body>
    <section class="section">
        <div class="container">
            <h1 class="title">Dimension Hopper</h1>
            <br>
            <div class="box">
                <canvas id="gameCanvas" width="800" height="400" tabindex="0"></canvas>
            </div>
            <div class="is-center" id="playGameButton", style="display: none;">
                <a href="/?map_name=random" class="button is-success is-huge mt-1">Play Game!</a>
            </div>
            <div id="scores" class="mt-4 hideable">
                <div class="columns">
                    <div class="column">
                        <div class="box">
                            <div class="columns">
                                <div class="column is-one-half">
                                        <img id="player-sprite-1" src="" alt="Sprite preview">
                                </div>
                                <div class="column">
                                    <h4 id="scorePlayer1" class="title is-3">Score: 0</h4>
                                    <button class="button is-small generateCharacterButton" data-player="1">Change Character</button>
                                </div>
                                <div class="column is-one-quarter">
                                    <img src="images/arrow.png" alt="Arrow keys" style="height: 50px">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="box">
                            <div class="columns">
                                <div class="column is-one-half">
                                    <img id="player-sprite-2" src="" alt="Sprite preview">
                                </div>
                                <div class="column">
                                    <h4 id="scorePlayer2" class="title is-3">Score: 0</h4>
                                    <button class="button is-small generateCharacterButton" data-player="2">Change Character</button>
                                </div>
                                <div class="column is-one-quarter">
                                    <img src="images/wasd.png" alt="Arrow keys" style="height: 50px">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="hideable">
                <div class="field has-addons">
                    <div class="control is-expanded">
                        <select id="styleDropdown" class="input"></select>
                    </div>
                    <div class="control">
                        <button id="downloadButton" class="button is-link">Dimension Hop!</button>
                    </div>
                </div>
            </div>
            <div class="hideable">
                <span id="progressStatus" style="display: block;"> .</span>
                <div class="progress is-small" id="progressContainer" display="None">
                    <progress class="progress is-primary" value="0" id="progressBar" max="100">0%</progress>

                </div>
            </div>
            <div class="hideable"> 
                <button id="editButton" class="button is-info mt-4">Edit Map</button>
                <button id="shareButton" class="button is-info mt-4">Share Level</button>
                <button id="openChallengeModal" class="button is-info mt-4">Record a Challenge</button>
                <a href="/?map_name=random" class="button is-success mt-4">Random Level</a>
                <a href="/images" class="button is-success mt-4">Gallery</a>
                
            </div>
    
            <div id="edit-tools" style="display: none;">
                <p>Click to edit map. Hold shift for larger areas.</p>
                <div>
                    <button id="clearButton" class="button is-warning">Clear All</button>
                    <button id="fillButton" class="button is-primary">Fill All</button>
                    <button id="randomButton" class="button is-primary">Randomize</button>
                </div>
            </div>
            <div id="style-edit-tools" style="display: none;">
                <label class="checkbox">
                    <input type="checkbox" id="architectureToggle" name="architectureToggle" checked>
                    Toggle Architecture
                </label>
                
                <div class="field">
                    <input type="range" id="bgSlider" min="0" max="255" value="0" class="slider">
                    <label for="bgSlider">Background Brightness</label>
                </div>
                
                <label class="checkbox">
                    <input type="checkbox" id="gradientCheckbox" name="gradientCheckbox">
                    Use Gradient
                </label>
                <br>
                
                <label class="checkbox">
                    <input type="checkbox" id="jaggyCheckbox" name="jaggyCheckbox">
                    Rough Edges
                </label>
                
                <div id="jaggyControls" style="display: none;">
                    <div class="field">
                        <label for="sections">Roughness number of sections</label>
                        <input type="range" id="sections" name="sections" min="2" max="8" class="slider">
                        <span id="sections-value"></span>
                    </div>
                    <div class="field">
                        <label for="deviation">Roughness Size</label>
                        <input type="range" id="deviation" name="deviation" min="0" max="15" class="slider">
                        <span id="deviation-value"></span>
                    </div>
                </div> 
                <div class="control is-expanded">
                    <input type="text"  id="levelDescription" value="jungle temple ruins overgrown with vines and ferns, shafts of light" class="input">
                </div>
                <div class="field has-addons" style="display: None">
                    <div class="control is-expanded">
                        <input type="text"  id="styleName" placeholder="Name of the style" class="input">
                    </div>
                    <div class="control">
                        <button id="saveStyle" class="button is-link">Save Style</button>
                    </div>
                </div>
                <br>
            </div>
            <div id="fps" style="display: none;"></div>
            <section class="section">
                <h3 class="subtitle">
                  What even is this thing?
                </h3>
                <p>
                    It's a game! Collect the treasure and jump on the other guy's head. The game play is inspired by memories of crowding 4 people around a single keyboard to play a game
                    called Jump 'n Bump, which we played for hours in middle school, even though it only had a single level. I wanted to 
                    recapture that feeling. I've also always loved games with level editors, and I wanted to make the act of creating a new 
                    level to play together as fun as possible.
                </p>
                <br>
                <p> 
                    This is also a hobby project built to explore the limits of using Stable Diffusion to illustrate levels for a 2D platformer
                    dynamically. The idea is that you can create a level by drawing a simple black and white image, and then the AI will illustrate
                    it for you. There are lots of places you can get AI to draw a picture for you, but I wanted to see if I could get it to draw
                    something with a specific structure that would show the important information you need to actually play the game. You can read
                    more about my journey <a href="https://generalrobots.substack.com/p/dimension-hopper-part-1">here.</a>
                </p>
                <br>
                <p> 
                    Its hosted on AWS 
                    and because AI is hungry for GPU, the instance costs me $12 a day, so this game might not be around forever (I'd not turn
                    down <a href="https://account.venmo.com/u/Benjie-Holson">donations to keep the server on longer</a>, especially as recently transistioned
                    Google Roboticist to  
                    <a href="https://generalrobots.substack.com/p/why-build-a-robot-company"> unpaid blogger</a> and hobbiest gamedev). 
                </p>
                <br>
                <p>
                    Huge thanks to Aaron Mandle for helping me with AWS, python environment, cuda, pytorth, nginx and many others. You can read
                    the code if you really want to <a href="https://github.com/robobenjie/diffusion-platformer/tree/master"> here</a>. I still have
                    plans for improvements, big and small, so stick around and see what happens.
                </p>
                <br>
                <p>
                    -Benjie
                </p>
              </section>
        </div>

        <!-- Share Level Modal -->
        <div class="modal" id="shareModal">
            <div class="modal-background"></div>
            <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Share Level</p>
                <button class="delete" aria-label="close" id="closeShareModal"></button>
            </header>
            <section class="modal-card-body">
                <!-- Content -->
                <p id="shareLink"></p>
            </section>
            <footer class="modal-card-foot">
                <button class="button is-success" id="copyButton">Copy</button>
                <button class="button" id="closeShareModalFooter">Close</button>
                <span id="copiedMessage"></span>
            </footer>
            </div>
        </div>

        <!-- Record Challenge Modal -->

        <div class="modal"  id="challengeModalStart">
            <div class="modal-background"></div>
            <div class="modal-card">
              <header class="modal-card-head">
                <p class="modal-card-title">Send a challenge to a friend</p>
                <button class="delete" aria-label="close" id="closeChallengeModal"></button>
              </header>
              <section class="modal-card-body">
                <p>Get as much treasure as you can in 30 seconds. Then we'll give you a link you can send to a friend to play against a recording of you.</p>
              </section>
              <footer class="modal-card-foot">
                <button class="button is-success" id="recordChallengeButton">Let's go</button>
                <button class="button" id="cancelChallengeButton">Cancel</button>
              </footer>
            </div>
          </div>

        <!-- Share Challenge Modal -->
        <div class="modal" id="shareChallengeModal">
            <div class="modal-background"></div>
            <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Send Your Challenge!</p>
                <button class="delete" aria-label="close" id="closeShareChallengeModal"></button>
            </header>
            <section class="modal-card-body">
                <!-- Content -->
                <p id="shareChallengeLink"></p>
            </section>
            <footer class="modal-card-foot">
                <button class="button is-success" id="copyChallengeButton">Copy</button>
                <button class="button" id="closeShareChallengeModalFooter">Close</button>
                <span id="copiedChallengeMessage"></span>
            </footer>
            </div>
        </div>

        <!-- Play Challenge Modal -->
        <div class="modal" id="challengeNotificationModal">
            <div class="modal-background"></div>
            <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">You've been challenged!</p>
                <button class="delete" aria-label="close" id="closeChallengeNotificationModal"></button>
            </header>
            <section class="modal-card-body">
                <!-- Content -->
                <p id="challengeNotificationMessage">Get ready to compete! Use the arrow keys to move, and collect as much treasure as you can in 30 seconds.</p>
            </section>
            <footer class="modal-card-foot">
                <button class="button is-success" id="PlayChallengeButton">Let's Play</button>
            </footer>
            </div>
        </div>

        <!-- Challenge End Modal -->
        <div class="modal" id="challengeEndModal">
            <div class="modal-background"></div>
            <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Challenge Over!</p>
                <button class="delete" aria-label="close" id="closeChallengeEndModal"></button>
            </header>
            <section class="modal-card-body">
                <!-- Content -->
                <p id="challengeEndMessage"></p>
            </section>
            <footer class="modal-card-foot">
                <button class="button is-success" id="challengeEndAcknowledgeButton">OK</button>
                <button class="button is-error" id="RetryChallengeButton">Retry!</button>
            </footer>
            </div>
        </div>



        <!-- Change Character Modal -->
        <div class="modal" id="generateCharacterModal">
            <div class="modal-background"></div>
            <div class="modal-card">
              <header class="modal-card-head">
                <p class="modal-card-title">Change Character</p>
                <button class="delete" aria-label="close" id="closeModal"></button>
              </header>
              <section class="modal-card-body">
                <!-- Content -->
                <section class="section">
                    <div class="container">
                        <div class="columns is-multiline is-mobile">
                            <div class="column has-text-centered" style="padding: 0.0rem; display: flex; justify-content: center; align-items: center;">
                                <div>
                                    <img id="character1" class="character-image" src="" alt="Character 1">
                                </div>
                            </div>
                            <div class="column has-text-centered" style="padding: 0.0rem; display: flex; justify-content: center; align-items: center;">
                                <div>
                                    <img id="character2" class="character-image" src="" alt="Character 2">
                                </div>
                            </div>
                            <div class="column has-text-centered" style="padding: 0.0rem; display: flex; justify-content: center; align-items: center;">
                                <div>
                                    <img id="character3" class="character-image" src="" alt="Character 3">
                                </div>
                            </div>
                            <div class="column has-text-centered" style="padding: 0.0rem; display: flex; justify-content: center; align-items: center;">
                                <div>
                                    <img id="character4" class="character-image" src="" alt="Character 4">
                                </div>
                            </div>
                            <div class="column has-text-centered" style="padding: 0.0rem; display: flex; justify-content: center; align-items: center;">
                                <button class="button" id="refreshCharacters">Refresh</button>
                            </div>
                        </div>
                    </div>
                </section>
                <form id="characterForm">
                  <div class="field">
                    <label class="label" for="characterDescription">Description</label>
                    <div class="field has-addons">
                        <div class="control is-expanded">
                            <input class="input" type="text" id="characterDescription" name="characterDescription" value="a person">
                        </div>
                    <div class="control">
                        <button class="button is-success" id="submitCharacter">Generate New</button>
                    </div>
                </div>
                <div>
                    <p class="help">Note: this model takes prompts as very loose suggestions, and ignores things it doesn't understand</p>
                    <span id="CharacterProgressStatus" style="display: block;"> .</span>
                    <div class="progress is-small" id="CharacterProgressContainer" display="None">
                        <progress class="progress is-primary" value="0" id="CharacterProgressBar" max="100">0%</progress>
                    </div>
                </div>
            </form>
            </section>
            <footer class="modal-card-foot">
            <button class="button" id="cancelCharacter">Cancel</button>
            </footer>
        </div>
    </div>
    </section>
    <script src="level_edit.js" type="module"></script>
    <script src="character_select.js" type="module"></script>
    <script src="challenge_mode.js" type="module"></script>
    <script src="sidescroller.js" type="module"></script>
</body>
